    1: from pathlib import Path
    1: from typing import Optional, Sequence, Union
       
    1: from pandas.compat._optional import import_optional_dependency
       
    1: from pandas.api.types import is_list_like
    1: from pandas.core.api import DataFrame
       
       
       def read_spss(
           path: Union[str, Path],
           usecols: Optional[Sequence[str]] = None,
    1:     convert_categoricals: bool = True,
    1: ) -> DataFrame:
           """
           Load an SPSS file from the file path, returning a DataFrame.
       
           .. versionadded 0.25.0
       
           Parameters
           ----------
           path : string or Path
               File path
           usecols : list-like, optional
               Return a subset of the columns. If None, return all columns.
           convert_categoricals : bool, default is True
               Convert categorical columns into pd.Categorical.
       
           Returns
           -------
           DataFrame
           """
           pyreadstat = import_optional_dependency("pyreadstat")
       
           if usecols is not None:
               if not is_list_like(usecols):
                   raise TypeError("usecols must be list-like.")
               else:
                   usecols = list(usecols)  # pyreadstat requires a list
       
           df, _ = pyreadstat.read_sav(
               path, usecols=usecols, apply_value_formats=convert_categoricals
           )
           return df
